<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phoenix-Eye</title>
    <link rel="stylesheet" href="styles/stylelogin.css">
    <link rel="shortcut icon" href="assets/imgs/Logo_com fundo.png" type="image/x-icon">
</head>

<body>

    <!-- HOME -->
    <div class="container">
        <div id="pagina">
            <div class="pagina_fundo_verde">


                <div id="card_login" class="card_login">
                    <p class="titulo_login">Login</p>
                    <div class="campo_login">

                        <input type="text" id="input_email_login" placeholder="Email:" required>
                        <img src="assets/icon/perfil.png">
                    </div>
                    <div class="campo_login">
                        <input type="password" id="input_email_senha" placeholder="Senha:" oninput="ValidarSenha()" required>
                        <img src="assets/icon/cadeado-seguro.png">
                    </div>
                    <p id="erros_senha_login" class="Erros_senha"></p>
                    <button onclick="ValidarLogin()" id="button_entrar">Entrar</button>
                </div>


                <div id="card_cadastro" class="vazio">
                    <p class="titulo_cadastro">Olá, Corpo de Bombeiros!</p>
                    <p class="subtitulo_cadastro">Cadastre seu funcionário!</p>
                    <div class="campo_cadastro">
                        <input type="text" id="input_nome_cadastro" placeholder="Nome:" required>
                        <img src="assets/icon/perfil.png">
                    </div>

                    <div class="campo_cadastro">
                        <input type="number" id="input_telefone_cadastro" placeholder="Telefone:" required>
                        <img src="assets/icon/telefone.png">
                    </div>

                    <div class="campo_cadastro">
                        <input type="text" id="input_email_cadastro" placeholder="Email:" required>
                        <img src="assets/icon/email.png">
                    </div>
                    <div class="campo_cadastro">
                        <input type="text" id="input_senha_cadastro" placeholder="Senha:" oninput="ValidarSenha()" required>
                        <img src="assets/icon/cadeado-seguro.png">
                    </div>
                    <p id="erros_senha_cadastro" class="Erros_senha"></p>
                    <button onclick="ValidarCadastro()" id="button_entrar">Cadastre-se</button>
                    <p id="ir_login" >Voltar <u onclick="Login()">Login</u></p>
                    <p class="ir_dash">Deseja ver a dash? <u onclick="dash()">Clique</u></p> 

                </div>
                    
                <div id="card_login_block" class="vazio">
                    <h1>Página bloqueada!</h1>
                    <img src="assets/icon/block.png" alt="">
                </div>

                <a href="indexclara.html"><button class="button_voltar">Voltar ao home</button></a>
            </div>
                
        </div>
    </div>
</body>

</html>
<script>
    var erros=0
    var nome = ""
    var telefone = ""
    var email = ""
    var senha = ""
    var email_padrao = "Corpodebombeiro@gov.br"
    var senha_padrao = "Urubu100@"


    var maiscula = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
    var minuscula = "abcdefghijklmnopqrstuvwxyz"
    var caracteres= "!@#$%^&*()_+-={}[]|\:;\<>,.?/~"
    var numeros= "0123456789"

    var senha_validada = false
        
    function Login(){
        input_email_login.value = ""
        input_email_senha.value = ""
        card_cadastro.className ='vazio'
        card_login.className = 'card_login'
    }
    function ValidarSenha(){
            senha_validada = false
            var senha_tentativa = ""

            var temMaisculasenha = false
            var temMinusculasenha = false
            var temCaractere = false
            var temnumero = false
            var problemasenha=""
            
            if(card_cadastro.className =='vazio'){
                senha_tentativa =input_email_senha.value.replaceAll(" ", "")
                
            }
            else{
                senha_tentativa=input_senha_cadastro.value.replaceAll(" ", "")
            }
            for(i=0;i<maiscula.length;i++){
                if(senha_tentativa.includes(maiscula[i])){
                    temMaisculasenha=true
                }
            }
            if(!temMaisculasenha){
                problemasenha+='A senha deve conter pelo menos 1 letra Maiúscula<br>'
            }
            for(i=0;i<minuscula.length;i++){
                if(senha_tentativa.includes(minuscula[i])){
                    temMinusculasenha=true
                }
            }

            if(!temMinusculasenha){
                problemasenha+='A senha deve conter pelo menos 1 letra Minúscula<br>'
            }

            for(i=0;i<caracteres.length;i++){
                if(senha_tentativa.includes(caracteres[i])){
                    temCaractere=true
                }
            }
            if(!temCaractere){
                problemasenha+='A senha deve conter pelo menos 1 caractere especial<br>'
            }

            for(i=0;i<numeros.length;i++){
                if(senha_tentativa.includes(numeros[i])){
                    temnumero=true
                }
            }
            if(!temnumero){
                problemasenha+='A senha deve conter pelo menos 1 número<br>'
            }
            
            if(senha_tentativa==""){
                erros_senha_login.innerHTML=""
                erros_senha_cadastro.innerHTML=""
            }
            else if(problemasenha.length>0){
                erros_senha_login.innerHTML=""
                erros_senha_login.innerHTML =`${problemasenha}`
                erros_senha_cadastro.innerHTML=""
                erros_senha_cadastro.innerHTML =`${problemasenha}`
            }
            else{
                erros_senha_login.innerHTML=""
                erros_senha_cadastro.innerHTML=""
                senha_validada=true
            }

        }

    function ValidarCadastro(){ 
        var nome_tentativa = input_nome_cadastro.value
        var telefone_tentativa = input_telefone_cadastro.value.replaceAll(" ","").replaceAll("-","")
        var email_tentativa = input_email_cadastro.value.replaceAll(" ", "");
        var senha_tentativa=input_senha_cadastro.value.replaceAll(" ", "")
        var problemaemail=""
        var problematelefone=""

            if(!email_tentativa.includes('@') && !email_tentativa.includes('.')){
                problemaemail+=`Problema no Email:Email inválido deve conter '@' e '.'`
            }
            else if(!email_tentativa.includes('@')){
                problemaemail+=`Problema no Email:Email inválido deve conter '@'`
            }
            else if(!email_tentativa.includes('.')){
                problemaemail+=`Problema no Email:Email inválido deve conter '.'`
            }

            if(telefone_tentativa.length>11 ||telefone_tentativa.length<9 ||telefone_tentativa.length==10){
                problematelefone+='Problema no telefone:Tamanho do número inválido'
            }
            else if(telefone_tentativa.length==9){
                problematelefone+='Problema no telefone:Número sem DDD'
            }


            if(problematelefone.length>0||problemaemail.length>0||!senha_validada){
                // adicionar mais coisas
                alert(`${problemaemail}\n${problematelefone}`)
            }
            else{
                if(senha_validada){
                    nome=nome_tentativa
                    telefone=telefone_tentativa
                    email=email_tentativa
                    senha=senha_tentativa   
                    alert('Cadastro realizado!')
                    card_cadastro.className ='vazio'
                    card_login.className = 'card_login'
                    input_email_login.value = ""
                    input_email_senha.value = ""
                }
                
            }
            
        }
            
    function ValidarLogin(){
        var email_tentativa = input_email_login.value.replaceAll(" ", "");
        var senha_tentativa = input_email_senha.value.replaceAll(" ", "");
        var problemaemail=""

        if(erros>2){
            card_login_block.className="card_login_block"
            card_login.className="vazio"
        }
        else{
            if(!email_tentativa.includes('@') && !email_tentativa.includes('.')){
                problemaemail+=`Problema no Email:Email inválido deve conter '@' e '.'`
            }
            else if(!email_tentativa.includes('@')){
                problemaemail+=`Problema no Email:Email inválido deve conter '@'`
            }
            else if(!email_tentativa.includes('.')){
                problemaemail+=`Problema no Email:Email inválido deve conter '.'`
            }
            
            if(problemaemail.length>0){
                erros++
                alert(`${problemaemail}\nRestam apenas ${4-erros} tentativas`)
            }
            else if(!senha_validada){
                alert(`Senha inválida\nRestam apenas ${4-erros} tentativas`)
            }
            else{
                if(email_tentativa==email && senha_tentativa==senha){
                    window.location.href = '/Dashboard/dashboard.html'
                }
                else if(email_tentativa==email_padrao && senha_tentativa==senha_padrao){
                    card_login.className ='vazio'
                    card_cadastro.className = 'card_cadastro'
                    input_nome_cadastro.value=""
                    input_telefone_cadastro.value=""
                    input_email_cadastro.value=""
                    input_senha_cadastro.value=""
                }
                else{
                    erros++
                    alert(`Sua senha ou email estão incorretos\nRestam apenas ${4-erros} tentativas`)
                }
            }
        }
    }
        
    function dash(){
        window.location.href = '/Dashboard/dashboard.html'
    }
            
</script>